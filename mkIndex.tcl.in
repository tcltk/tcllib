# mkIndex.tcl --
#
#	This script generates a pkgIndex.tcl file for an installed extension.
#
# Copyright (c) 1999 Scriptics Corporation.
#
# See the file "license.terms" for information on usage and redistribution
# of this file, and for a DISCLAIMER OF ALL WARRANTIES.
#
#
# Notes:
#
# If you redefine $(libdir) using the configure switch --libdir=, then
# this script will probably fail for you.
#
#        prefix
#           |
#           |
#           |
#          lib
#          /
#         /
#        /
#   PACKAGE
#       |
#       |
#       |
#  pkgIndex.tcl
#
       
set prefix "@prefix@"

set package @PACKAGE@
set version @VERSION@

cd [file join $prefix lib "$package$version"]
puts "Making pkgIndex.tcl in [pwd]"

set modules $argv
#foreach f [glob -nocomplain ./*] {
#    if { [file isdirectory $f] } {
	# Found an installed module, add it to the list
#	lappend modules [file tail $f]
#    }
#}

set index [open pkgIndex.tcl w]
puts $index "if { \[lsearch \$auto_path \[file dirname \[info script\]\]\] } {"
puts $index "\tlappend auto_path \[file dirname \[info script\]\]"
puts $index "}"
puts $index "package ifneeded $package $version {"
foreach module $modules {
    puts $index "\tpackage require $module"
}
puts $index "\tpackage provide $package $version"
puts $index "}"
